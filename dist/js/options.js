(()=>{"use strict";const e=async()=>{const e=document.getElementById("subredditInput").value;await t(e)},t=async e=>{if(e in await chrome.storage.local.get(e))console.log("Duplicate subreddit "+e+" was not added");else{const t={};t[e]={filterCategory:"before",filterDateTime:r(new Date),isActive:!1},await chrome.storage.local.set(t),n(e,null,null,null,null)}},n=(e,t,n,c,i)=>{let r=document.getElementById("subreddits").getElementsByTagName("tbody")[0].insertRow();r.setAttribute("class","subreddit"),l(r,e),a(r,t),s(r,n),d(r,c),o(r,i)},l=(e,t)=>{const n=c(e),l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("class","subreddit-name"),l.setAttribute("name",t),l.required=!0,l.value=t,n.appendChild(l)},a=(e,t)=>{const n=c(e),l=["before","after"],a=document.createElement("select");a.setAttribute("class","subreddit-filter-categories");for(let e of l){let t=document.createElement("option");t.innerHTML=e,t.value=e,a.appendChild(t)}a.value=null!==t?t:l[0],n.appendChild(a)},s=(e,t)=>{const n=c(e),l=document.createElement("input");l.setAttribute("type","datetime-local"),l.setAttribute("class","subreddit-datetime-local"),l.required=!0,l.value=null!==t?u(t):(new Date).toLocaleString("sv").slice(0,-3),n.appendChild(l)},d=(e,t)=>{const n=c(e),l=document.createElement("input");l.setAttribute("type","checkbox"),l.setAttribute("class","subreddit-activebox"),l.checked=null!==t&&t,n.appendChild(l)},o=(e,t)=>{const n=c(e),l=document.createElement("input");l.setAttribute("type","checkbox"),l.setAttribute("class","subreddit-selectedbox"),l.checked=null!==t&&t,n.appendChild(l)},c=e=>e.insertCell(),i=()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0],t=[];for(let n=0;n<e.rows.length;n++){let l=e.rows[n],a=l.children[0].getElementsByTagName("input")[0].getAttribute("name"),s=l.children[0].getElementsByTagName("input")[0].value,d=l.children[1].getElementsByTagName("select")[0].value,o=l.children[2].getElementsByTagName("input")[0].value,c=l.children[3].getElementsByTagName("input")[0].checked;const i={};i[s]={filterCategory:d,filterDateTime:r(o),isActive:c},chrome.storage.local.set(i,(()=>{})),a!==s&&t.push(a),l.children[0].getElementsByTagName("input")[0].setAttribute("name",s)}chrome.storage.local.remove(t,(()=>{}))},r=e=>new Date(e).toISOString().slice(0,-8),u=e=>{const t=(new Date).getTimezoneOffset(),n=new Date(e);return n.setMinutes(n.getMinutes()-t),n.toLocaleString("sv").slice(0,-3)};(async()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0];let t=0;for(;t<e.rows.length;)e.deleteRow(t),t++;const l=await chrome.storage.local.get(null);for(let e in l){let t=e,a=l[e].filterCategory,s=l[e].filterDateTime,d=l[e].isActive;n(t,a,s,d,null)}})(),(()=>{const t=document.getElementById("addButton"),n=document.getElementById("deleteButton"),l=document.getElementById("updateButton"),a=document.getElementById("subredditInput");document.addEventListener("DOMContentLoaded",(()=>{t.addEventListener("click",(async()=>{try{await e()}catch(e){console.log(e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{a.addEventListener("keyup",(async t=>{if("Enter"===t.key)try{await e()}catch(e){console.log(e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{n.addEventListener("click",(async()=>{try{await(async()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0],t=[];let n=0;for(;n<e.rows.length;){let l=e.rows[n];if(l.children[4].getElementsByTagName("input")[0].checked){let a=l.children[0].getElementsByTagName("input")[0].value;t.push(a),e.deleteRow(n)}else n++}await chrome.storage.local.remove(t)})()}catch(e){console.log(e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{l.addEventListener("click",(()=>{try{(()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0],t={};let n=!0;for(let l=0;l<e.rows.length;l++){let a=e.rows[l],s=a.children[0].getElementsByTagName("input")[0].value,d=a.children[2].getElementsByTagName("input")[0].value;if(t[s]||""===s||""===d){n=!1;break}t[s]=!0}n?i():console.log("Duplicate or invalid field was inputted")})()}catch(e){console.log(e)}}))}))})()})();