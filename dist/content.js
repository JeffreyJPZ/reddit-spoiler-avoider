(()=>{const e="oldReddit",t="newRedditSubreddit",r="newRedditHome";chrome.runtime.onMessage.addListener(((e,t,r)=>{const a=JSON.parse(e);return"filter"===a.key&&(o(a.data),s().then(r(""))),!0}));const s=async()=>{let s,i=document.getElementById("main-content");if(null===i)i=document.getElementById("siteTable"),s=e;else{const e=i.getElementsByTagName("shreddit-feed");e.length>0?(i=e[0],s=r):(i=i.children[2],s=t)}const d=JSON.parse(window.localStorage.getItem("subredditFilterOptions"));a(i,d)&&n(i,d,s)},a=(e,t)=>null!==t&&null!==e,n=(r,s,a)=>{for(let o of r.children)a===t&&"FACEPLATE-BATCH"===o.tagName||a===e&&"sitetable linklisting"===o.getAttribute("class")?n(o,s,a):i(o,a)&&d(o,s,a)&&l(r,o,a)},i=(s,a)=>{switch(a){case e:return 0!==s.getAttribute("data-subreddit");case t:case r:return"ARTICLE"===s.tagName;default:return!1}},d=(s,a,n)=>{let i,d;switch(n){case e:i=s.getAttribute("data-subreddit"),d=parseFloat(s.getAttribute("data-timestamp"));break;case t:case r:i=s.getElementsByTagName("shreddit-post")[0].getAttribute("subreddit-prefixed-name").substring(2),d=s.getElementsByTagName("shreddit-post")[0].getAttribute("created-timestamp")}const l=a[i];if(void 0===l)return!1;const o=l.filterCategory,c=new Date(l.filterDateTime+"Z"),u=new Date(d);return"before"===o&&u<=c||"after"===o&&u>=c},l=(s,a,n)=>{switch(n){case e:case t:case r:s.removeChild(a);break;default:return}},o=e=>{window.localStorage.setItem("subredditFilterOptions",JSON.stringify(e))};try{chrome.runtime.sendMessage(JSON.stringify({key:"requestFilters"})).then()}catch(e){console.log(e)}setInterval((()=>{try{s().then()}catch(e){console.log(e)}}),4)})();