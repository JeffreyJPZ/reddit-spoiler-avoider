(()=>{"use strict";const e=async e=>{chrome.storage.local.get(e,(async n=>{if(e in n)console.log("Duplicate subreddit "+e+" was not added");else{const n={},l={filterCategory:"before"};l.filterDateTime=i(new Date),l.isActive=!1,n[e]=l,await chrome.storage.local.set(n),console.log("Subreddit "+e+" added"),t(e,null,null,null,null)}}))},t=(e,t,o,d,i)=>{let r=document.getElementById("subreddits").getElementsByTagName("tbody")[0].insertRow();r.setAttribute("class","subreddit"),n(r,e),l(r,t),a(r,o),s(r,d),c(r,i)},n=(e,t)=>{const n=o(e),l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("class","subreddit-name"),l.setAttribute("value",t),l.required=!0,l.value=t,n.appendChild(l)},l=(e,t)=>{const n=o(e),l=["before","after"],a=document.createElement("select");a.setAttribute("class","subreddit-filter-categories");for(let e of l){let t=document.createElement("option");t.innerHTML=e,t.value=e,a.appendChild(t)}a.value=null!==t?t:l[0],n.appendChild(a)},a=(e,t)=>{const n=o(e),l=document.createElement("input");l.setAttribute("type","datetime-local"),l.setAttribute("class","subreddit-datetime-local"),l.required=!0,l.value=null!==t?r(t):(new Date).toLocaleString("sv").slice(0,-3),n.appendChild(l)},s=(e,t)=>{const n=o(e),l=document.createElement("input");l.setAttribute("type","checkbox"),l.setAttribute("class","subreddit-activebox"),l.checked=null!==t&&t,n.appendChild(l)},c=(e,t)=>{const n=o(e),l=document.createElement("input");l.setAttribute("type","checkbox"),l.setAttribute("class","subreddit-selectedbox"),l.checked=null!==t&&t,n.appendChild(l)},o=e=>e.insertCell(),d=async()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0];for(let t=0;t<e.rows.length;t++){let n=e.rows[t],l=n.children[0].getElementsByTagName("input")[0].getAttribute("value"),a=n.children[0].getElementsByTagName("input")[0].value,s=n.children[1].getElementsByTagName("select")[0].value,c=n.children[2].getElementsByTagName("input")[0].value,o=n.children[3].getElementsByTagName("input")[0].checked;await chrome.storage.local.remove(l);const d={};d[a]={filterCategory:s,filterDateTime:i(c),isActive:o},await chrome.storage.local.set(d),n.children[0].getElementsByTagName("input")[0].setAttribute("value",a)}},i=e=>new Date(e).toISOString().slice(0,-8),r=e=>{const t=(new Date).getTimezoneOffset(),n=new Date(e);return n.setMinutes(n.getMinutes()-t),n.toLocaleString("sv").slice(0,-3)};(()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0];let n=0;for(;n<e.rows.length;)e.deleteRow(n),n++;chrome.storage.local.get(null,(e=>{for(let n in e){let l=n,a=e[n].filterCategory,s=e[n].filterDateTime,c=e[n].isActive;t(l,a,s,c,null)}}))})(),(()=>{const t=document.getElementById("addButton"),n=document.getElementById("deleteButton"),l=document.getElementById("updateButton");document.addEventListener("DOMContentLoaded",(()=>{t.addEventListener("click",(async()=>{try{await(async()=>{const t=document.getElementById("subredditInput").value;await e(t)})()}catch(e){console.log(e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{n.addEventListener("click",(async()=>{try{await(async()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0],t=[];let n=0;for(;n<e.rows.length;){let l=e.rows[n];if(l.children[4].getElementsByTagName("input")[0].checked){let a=l.children[0].getElementsByTagName("input")[0].value;t.push(a),e.deleteRow(n)}else n++}await chrome.storage.local.remove(t)})()}catch(e){console.log(e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{l.addEventListener("click",(async()=>{try{await(async()=>{const e=document.getElementById("subreddits").getElementsByTagName("tbody")[0],t={};let n=!0;for(let l=0;l<e.rows.length;l++){let a=e.rows[l],s=a.children[0].getElementsByTagName("input")[0].value,c=a.children[2].getElementsByTagName("input")[0].value;if(t[s]||""===s||""===c){n=!1;break}t[s]=!0}n?await d():console.log("Duplicate name inputted")})()}catch(e){console.log(e)}}))}))})()})();